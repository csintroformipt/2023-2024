Цели и задачи курса
Цель курса «Основы численного моделирования физических процессов» – дать студентам практикум программирования на примере моделирования простых физических процессов.
Курс выполнят две задачи: дать студентам базовые практические навыки использования языка C++ в области численного моделирования и практику использования библиотек Python для обработки данных и анализа полученных результатов. При этом внимание студентов акцентируется не на глубоком изучении синтаксических особенностей и средств каждого из данных языков, а на их практически значимых аспектах, которые часто оказываются ключевыми при написании численных моделей. В частности особое внимание уделяется влиянию машинной точности на результаты моделирования, а также на важность правильного выполнения декомпозиции алгоритма для достижения необходимой гибкости и производительности симулятора. По окончании курса студенты получат опыт программирования численных схем, конструирования гибкого кода и анализа полученных результатов, а также дополнительные навыки использования базовых средств отладки и профилирования кода.

Формат проведения занятий
Очные семинарские занятия 2 пары подряд. В случае пропуска может потребоваться самостоятельная домашняя работа по материалам занятия. Возможно использовать собственный ПК вместо оборудования в компьютерных классах без ограничений. 

Требования к слушателям
Данный курс задумывался как независимый курс, существенно расширяющий практические возможности студентов, приобретённые в ходе курса информатики на первом году обучения. Поэтому при составлении программы предполагалось, что студенты в полной мере овладели программой первого года обучения. Однако же, если в ходе занятий у обучающегося обнаруживаются пробелы в критически важных для выполнения задания областях, проводится краткий ликбез по мере необходимого.

Зачёт
Оценка выставляется по совокупности работы в семестре и состоит из двух частей. Первая часть – оценка качества кода и представления результатов. Вторая часть – теоретическая, физический смысл результатов, понимание применяемых численных методов. В спорных случаях студенты могут дополнительно выполнить лабораторные для повышения баллов.

Семестр I


Неделя 1
Повторение стандартных последовательных контейнеров C++: std::vector и std::array. Запись и чтение текстовых файлов стандартными потоками ввода-вывода: std::fstream, std::ofstream, std::ifstream. Использование бинарных форматов хранения данных.


Неделя 2
Повторение стандартных средств языка Python для импорта и представления данных. Знакомство со стандартными массивами NumPy. Чтение, запись, совместимость форматов хранения массивов. Средтсва для построения графиков в библиотеке Matplotlib. Расширенные средства для работы с интерактивными графиками в Bokeh//Plotly.


Неделя 3
Моделирование движения математического маятника  с использованием простейшей схемы Эйлера.
Лекционный материал:
Решение уравнения движения простейшим одношаговым методом Эйлера первого порядка точности. Представление решения в виде траектории в фазовом пространстве.
Лабораторная.
Проверить зависит ли период колебаний системы от амплитуды, численно проинтегрировав уравнение движение. Проверить закон сохранения энергии. Сравнить траектории в фазовом пространстве для численного и точного решений при различных начальных условиях.


Неделя 4
Влияние конечности представления чисел с плавающей точкой на точность вычислений. 
Лекционный материал:
Внутреннее представление чисел с плавающей точкой. Ошибки округления и «машинное эпсилон». Суммирование гармонического ряда в прямом и обратном порядке.
Лабораторная.
Проверка точности сохранения полной энергии в задаче о математическом маятнике при уменьшении шага по времени. Построить график зависимости относительной ошибки сохранения инварианта от шага, объяснить наблюдаемые особенности. Сравнить графики для чисел одинарной (float) и двойной (double) точности.


Неделя 5
Завершение лабораторной по математическому маятнику. Проверка кода (code review) и выставление оценок.


Неделя 6
Моделирование движения физического маятника  с использованием схемы второго порядка.
Лекционный материал:
Схемы второго порядка для решения уравнения движения. Метод Хьюна (неявный) и метод предиктор-корректор, схема Хойна (явный).
Лабораторная:
Сравнить траектории колебаний с малым начальным отклонением с решениями для математического маятника. Путём численного моделирования описать различные типы решений в зависимости от начальных условий.


Неделя 7
Использование шаблонов C++ для повышения гибкости программного кода.
Лекционный материал:
Шаблоны как способ генерации зависящего от типа кода. Написание численной схемы универсальным образом для чисел одинарной и двойной точности. Использование шаблонов для разделения кода физической модели и численной схемы.
Лабораторная:
Разделить части кода, относящиеся к физической задаче, численной схеме и экспорта данных, используя механизм классов и шаблонов. Провести моделирование с использованием схем первого и второго порядков точности. Организовать код универсальным образом для использования чисел разной точности. Сравнить зависимости точности сохранения энергии в различных схемах для чисел разной точности.


Неделя 8
Завершение лабораторной по физическому маятнику. Проверка кода (code review) и выставление оценок.


Неделя 9
Моделирование движения физического маятника с затуханием  с использованием схемы второго порядка. Использование возможностей Python для анимации.
Лекционный материал:
Создание набора графиков в зависимости от параметра. Использование времени как параметра для построения графика. Экспорт набора параметризованных графиков.
Лабораторная работа:
Используя численное моделирование, сравнить малые колебания физического маятника и физического маятника с затуханием. Описать особенности траекторий в фазовом пространстве при различных начальных условиях. Провести анализ зависимости полной энергии от времени.


Неделя 10
Моделирование движения физического маятника с затуханием при наличии гармонической внешней силы  с использованием схемы второго порядка.
Лабораторная работа:
Используя численное моделирование, проанализировать зависимость траекторий в фазовом пространстве для различных значений частоты периодической вынуждающей силы. Построить зависимость амплитуда установившихся колебаний от частоты вынуждающей силы.


Неделя 11
Моделирование движения физического маятника с затуханием при наличии периодической негармонической внешней силы , где  с использованием схемы второго порядка.
Лабораторная работа:
Сравнить результаты расчёта с ранее полученными результатами для гармонической силы.

Неделя 12
Моделирование движения двойного физического маятника с заданными плечами и массами. Построить траектории масс в фазовом и двумерном координатном пространством для различных начальных условий. Продемонстрировать хаотическое поведение. Исследовать зависимость ошибки по полной энергии системы от параметров численной схемы.

Неделя 13
Завершение лабораторной по физическому маятнику. Проверка кода (code review) и выставление оценок.


Дополнительная лабораторная 1
Самостоятельно ознакомиться с алгоритмом суммирования Кэхэна. Продемонстрировать алгоритм на примере интегрирования непрерывной функции. Внедрить алгоритм Кэхэна в задачу моделирования физического маятника и сравнить зависимости ошибки сохранения энергии от шага по времени для наивного суммирования и алгоритма Кэхэна.

Дополнительная лабораторная 2
Написать программу, моделирующую движение заряженной частицы в магнитном поле в перпендикулярной вектору индукции плоскости. Показать, что при наличии поперечного к вектору индукции градиента величины индукции возникает эффект дрейфа ведущего центра. Рассмотреть дрейф для различного знака заряда и различных соотношений заряда к массе. Численно оценить кольцевой дрейфовый ток в дипольном магнитном поле в плоскости, перпендикулярной оси диполя.
